# NobodyClimb 功能實作狀態對照表

> **更新日期**：2026-01-27
> **對照基準**：service-design 系列文件中的 MVP 規劃

---

## 一、整體進度摘要

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          MVP 功能實作進度                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  已完成 ███████████████████████████████████████████████░░  約 95%           │
│                                                                             │
│  ✅ 用戶系統        ✅ 人物誌基礎      ✅ 通知系統完整    ✅ 追蹤/按讚      │
│  ✅ 人生清單        ✅ 徽章系統        ✅ 首頁精選人物誌  ✅ 故事評論系統   │
│  ✅ 故事按讚        ✅ 匿名故事分享    ✅ 熱門故事 API                       │
│                                                                             │
│  ⚠️ 可優化：引導式問答 UI、首頁精選故事整合、OG Image                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、MVP 功能對照表

### P0：沒有就不能上線

| 功能 | 規劃說明 | 狀態 | 備註 |
|------|---------|------|------|
| 社群登入 | Google/FB 一鍵註冊 | ✅ 已完成 | Google OAuth 已實作 |
| Email 註冊/登入 | 本地帳號系統 | ✅ 已完成 | 含密碼重設功能 |
| 基本個人頁面 | 用戶基本資料展示 | ✅ 已完成 | `/profile` 頁面 |
| 核心故事填寫 | 3 題引導式問答 | ✅ 已完成 | 故事欄位完整，可優化引導 UI |
| 故事展示頁 | 公開個人頁面 | ✅ 已完成 | `/biography/profile/[slug]` |
| **故事評論** | 在別人故事下留言 | ✅ **已完成** | ContentCommentSheet 組件 |
| 基礎通知 | 有人評論時通知 | ✅ **已完成** | 15 種通知類型完整支援 |

### P1：上線後第一週要有

| 功能 | 規劃說明 | 狀態 | 備註 |
|------|---------|------|------|
| **快速評論按鈕** | 「我也是」「+1」 | ⚠️ 設計簡化 | 目前使用按讚替代，可選加入 |
| 按讚功能 | 對故事/評論按讚 | ✅ **已完成** | likes 表支援所有故事類型 |
| 首頁精選 | 展示優質故事 | ⚠️ API 已有 | 熱門 API 完成，需整合到首頁 |
| 追蹤功能 | 追蹤有趣的人 | ✅ 已完成 | 完整實作 |

### P2：上線後兩週內

| 功能 | 規劃說明 | 狀態 | 備註 |
|------|---------|------|------|
| 追蹤通知 | 有人追蹤你 | ✅ 已完成 | `new_follower` 類型 |
| 簡易探索 | 瀏覽其他用戶 | ✅ 已完成 | `/biography/explore` |
| 分享優化 | OG Image 預覽圖 | ❌ 未實作 | 需開發 |

---

## 三、已實作功能清單（超出 MVP 範圍）

### 原規劃 Phase 2+ 但已實作

| 功能 | 原規劃階段 | 實作狀態 | 說明 |
|------|-----------|---------|------|
| 人生清單系統 | Phase 2 | ✅ 完整實作 | CRUD、進度、評論、按讚、啟發 |
| 攀岩足跡 | Phase 2 | ✅ 完整實作 | 位置管理、探索、統計 |
| 徽章系統 | Phase 4 | ✅ 完整實作 | 12 個徽章、進度追蹤 |
| 排行榜 | Phase 4 | ✅ 已實作 | 目標完成、追蹤者、按讚 |
| 社群統計 | Phase 4 | ✅ 已實作 | 社群數據儀表板 |
| 遊戲系統 | Phase 5 | ✅ 基礎實作 | rope-system 繩索學習遊戲 |
| **匿名故事分享** | 未規劃 | ✅ **新功能** | 訪客分享、資格判定、認領機制 |

### 其他已實作功能

| 功能 | 說明 |
|------|------|
| 部落格系統 | 文章 CRUD、草稿、發布 |
| 相片集系統 | 相片集管理、多圖上傳 |
| 影片系統 | YouTube 影片瀏覽器 |
| 岩館資料 | 室內岩館資訊 |
| 戶外岩場 | 岩場、區域、路線資料 |
| 評論系統 | 多實體類型評論（支援故事） |
| 搜尋系統 | 全站搜尋 |
| 管理後台 | 用戶管理、內容管理、分析 |
| 推題系統 | 故事撰寫提示推送 |
| 瀏覽追蹤 | 瀏覽次數、去重機制 |
| **訪客 Session** | 追蹤訪客活動、計算分享資格 |

---

## 四、已完成的 MVP 核心功能

### ✅ 故事評論系統（已完成）

Migration 0027 已擴展 `comments` 表支援故事類型。

**資料庫 Schema：**
```sql
-- comments 表 entity_type 支援：
'biography', 'post', 'bucket_list_item',
'core_story', 'one_liner', 'story',
'gallery', 'video', 'gym', 'crag', 'route'

-- 表結構包含：
like_count INTEGER DEFAULT 0,      -- 留言按讚數
reply_count INTEGER DEFAULT 0,     -- 回覆數
```

**已完成 API（biography-content.ts）：**
- `GET /core-stories/:id/comments` - 取得評論列表
- `POST /core-stories/:id/comments` - 新增評論（支援回覆）
- `POST /core-stories/:id/like` - 按讚/取消按讚
- `DELETE /core-story-comments/:id` - 刪除評論
- 一句話、深度故事同樣完整支援

**已完成 UI 組件：**
- `ContentCommentSheet` - 故事評論 Sheet
- `ContentLikeButton` - 內容按讚按鈕
- `StoryCard` - 故事卡片（支援展開/截斷）

### ✅ 通知系統（已完成）

**支援 15 種通知類型：**
```typescript
'core_story_liked'      // 核心故事被按讚
'core_story_commented'  // 核心故事收到評論
'one_liner_liked'       // 一句話被按讚
'one_liner_commented'   // 一句話收到評論
'story_liked'           // 深度故事被按讚
'story_commented'       // 深度故事收到評論
'biography_commented'   // 人物誌收到評論
'new_follower'          // 新追蹤者
// ... 等 15 種
```

### ✅ 匿名故事分享系統（新功能）

**資料庫表：**
- `guest_sessions` - 訪客 Session 追蹤
- `content_claims` - 內容認領紀錄
- `share_eligibility_config` - 分享資格配置

**API 端點（guest.ts）：**
- `POST /session` - 建立訪客 Session
- `POST /session/track` - 追蹤活動
- `POST /biography` - 提交匿名人物誌
- `POST /biography/:slug/claim` - 認領內容

---

## 五、可優化項目

### 🟡 中優先：首頁精選故事整合

熱門故事 API 已完成，需整合到首頁展示。

**已有 API：**
- `GET /popular/core-stories`
- `GET /popular/one-liners`
- `GET /popular/stories`

**需新增：**
- 首頁精選故事區塊組件
- 整合到 `src/app/page.tsx`

### 🟡 中優先：引導式問答 UI

目前故事填寫是傳統表單形式，可優化為引導式問答體驗。

#### 可調整

- 註冊後引導流程：一題一題問
- 人物誌編輯頁面：漸進式填寫體驗
- 空狀態設計：鼓勵性文案

### 🟢 低優先：快速反應按鈕

設計已完成（見 quick-reaction-design.md），實作可選。

目前使用「按讚」已可滿足基本互動需求。如需增加互動趣味，可加入：
- 「我也是」- 表達相同經歷
- 「+1」- 表示認同
- 「說得好」- 讚賞表達

### 🟢 低優先：OG Image 分享預覽

分享到社群時的預覽圖自動生成。

---

## 六、建議的開發順序

根據 2026-01-27 最新狀態，建議調整 Sprint 計畫：

### ✅ Sprint 1-2：已完成

```
已完成功能：
✅ 故事評論系統（comments 表支援 core_story, one_liner, story）
✅ 故事按讚系統（likes 表支援）
✅ 通知系統（15 種類型完整）
✅ 熱門故事 API
✅ 匿名故事分享系統
```

### Sprint 3（當前）：首頁精選故事整合

```
Week 1-2：整合與優化
□ 首頁新增精選故事區塊（使用現有 /popular/* API）
□ 設計精選故事卡片組件
□ 整合到首頁 layout
```

### Sprint 4：引導式體驗優化（可選）

```
Week 3-4：UX 優化
□ 引導式問答 UI 組件
□ 註冊後引導流程調整
□ 空狀態設計優化
□ 文案調整
```

### Sprint 5：分享與上線準備

```
Week 5-6：優化與上線
□ OG Image 自動生成
□ 分享預覽優化
□ 效能優化
□ Bug 修復
□ 種子內容準備
```

---

## 七、技術債與注意事項

### 已知技術債

| 項目 | 說明 | 建議處理時機 |
|------|------|-------------|
| 前端狀態管理 | 部分使用 Zustand，部分使用 TanStack Query | 持續統一 |

### 設計說明：故事表結構

> ⚠️ 注意：「故事存儲分三個表」**不是技術債**，而是有意的設計。

目前故事資料分為三個表：

| 表格 | 用途 | 特點 |
|------|------|------|
| `biography_core_stories` | 3 個核心問題 | 固定 question_id |
| `biography_one_liners` | 一句話問答 | 支援系統題/用戶自訂題 |
| `biography_stories` | 完整故事 | 支援分類 (category_id) |

**設計優點**：
- 每個表都有 `like_count`, `comment_count`，支援獨立互動
- 支援 `is_hidden`, `is_featured` 等管理功能
- 不同故事類型有不同欄位需求，分表更清晰

### 已完成的架構設計

**評論系統架構**：
- `comments` 表 entity_type 支援：biography, post, bucket_list_item, core_story, one_liner, story, gallery, video, gym, crag, route
- 支援巢狀回覆（parent_id）
- 自動維護 like_count, reply_count

**按讚系統架構**：
- `likes` 表支援多種 entity_type
- `biography_likes` 表專門處理人物誌級別按讚

**匿名分享架構**：
- `guest_sessions` 追蹤訪客活動
- 可配置分享資格門檻
- 支援後續認領機制

### 相容性注意

- 故事評論已相容現有的人物誌可見性設定（private、anonymous、community、public）
- 評論通知已整合現有通知偏好設定

---

## 八、對照總結

### MVP 核心驗證假設

| 假設 | 需要的功能 | 目前狀態 |
|------|-----------|---------|
| 用戶不寫是因為「覺得自己沒什麼特別」 | 引導式問答、文案優化 | ⚠️ 可優化 |
| 降低門檻可以提高參與 | 一題一題問的 UI | ⚠️ 可優化 |
| **社群評論可以激勵用戶持續貢獻** | **故事評論系統** | ✅ **已完成** |
| **匿名分享降低心理障礙** | **匿名故事分享** | ✅ **已完成**（新功能） |

### 結論

**🎉 MVP 核心功能已基本完成！**

已完成的關鍵功能：
1. ✅ 故事評論系統（含回覆、按讚）
2. ✅ 15 種通知類型完整
3. ✅ 熱門故事 API
4. ✅ 匿名故事分享系統（超出原規劃）

建議接下來優化：
1. 首頁精選故事整合（API 已有，需整合 UI）
2. 引導式問答體驗
3. OG Image 分享預覽

專案已具備進行 MVP 上線和假設驗證的條件。

---

## 更新記錄

| 日期 | 版本 | 更新內容 |
|------|------|----------|
| 2025-01-25 | v1.0 | 初始版本，對照專案實作狀態 |
| 2026-01-25 | v1.1 | 更新故事評論系統設計：改為擴展現有通用表 |
| 2026-01-27 | v1.2 | 重大更新：確認故事評論系統、通知系統已完成。新增匿名故事分享系統狀態。MVP 進度從 65% 提升至 95%。 |
