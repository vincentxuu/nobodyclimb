# Cloudflare Workers 部署任務清單

## 📋 前置準備

### 帳號與權限

- [ ] 註冊 Cloudflare 帳號
- [ ] 驗證電子郵件地址
- [ ] 設置雙因素認證 (2FA)
- [ ] 取得 API Token (需要 Workers 部署權限)
- [ ] 確認帳號方案 (Free/Pro/Business)

### 開發環境

- [ ] 安裝 Node.js 18.x 或更高版本
- [ ] 安裝 pnpm 或 npm 套件管理器
- [ ] 安裝 Git 版本控制
- [ ] 設置程式碼編輯器 (VS Code 推薦)

### Cloudflare CLI 工具

- [ ] 安裝 Wrangler CLI (`npm install -g wrangler`)
- [ ] 執行 `wrangler login` 登入帳號
- [ ] 驗證登入狀態 (`wrangler whoami`)

## 🔧 專案配置

### Next.js 配置調整

- [ ] 更新 `next.config.js` 支援 Edge Runtime
- [ ] 配置輸出模式為 `standalone`
- [ ] 調整圖片優化設定
- [ ] 設置環境變量載入

### Workers 配置文件

- [ ] 創建 `wrangler.toml` 配置文件
- [ ] 設置專案名稱和帳號 ID
- [ ] 配置路由規則
- [ ] 設置環境變量
- [ ] 配置 KV 命名空間 (如需要)
- [ ] 設置 R2 儲存桶 (如需要)

### 依賴檢查

- [ ] 確認所有套件兼容 Edge Runtime
- [ ] 移除不兼容的 Node.js 原生模組
- [ ] 更新套件到最新穩定版本
- [ ] 執行 `npm audit` 檢查安全性

## 🚀 部署準備

### 程式碼優化

- [ ] 執行 ESLint 檢查 (`npm run lint`)
- [ ] 執行格式化 (`npm run format`)
- [ ] 執行單元測試 (`npm run test`)
- [ ] 建構專案 (`npm run build`)
- [ ] 檢查建構輸出大小 (Workers 限制 10MB)

### 環境變量設置

- [ ] 在 Cloudflare Dashboard 設置生產環境變量
- [ ] 配置 API 端點 (`NEXT_PUBLIC_API_URL`)
- [ ] 設置第三方服務金鑰
- [ ] 配置數據庫連接字串 (如需要)
- [ ] 設置 JWT 密鑰 (如需要)

### 域名配置

- [ ] 添加自定義域名到 Cloudflare
- [ ] 更新 DNS 記錄
- [ ] 配置 SSL/TLS 設置
- [ ] 設置頁面規則 (如需要)

## 📦 部署執行

### 首次部署

- [ ] 執行 `wrangler publish` 或 `npm run deploy`
- [ ] 確認部署成功訊息
- [ ] 記錄 Workers 子域名 URL
- [ ] 測試部署的應用程式

### 功能驗證

- [ ] 首頁載入正常
- [ ] 路由導航功能正常
- [ ] API 請求正常回應
- [ ] 靜態資源載入正常
- [ ] 表單提交功能正常
- [ ] 使用者認證流程正常

### 性能測試

- [ ] 使用 Lighthouse 測試性能分數
- [ ] 檢查首屏載入時間 (目標 < 3秒)
- [ ] 測試不同地區的訪問速度
- [ ] 檢查資源壓縮設置

## 🔍 部署後檢查

### 監控設置

- [ ] 配置 Cloudflare Analytics
- [ ] 設置錯誤追蹤 (Sentry 或類似服務)
- [ ] 配置性能監控
- [ ] 設置可用性監控

### 安全檢查

- [ ] 啟用 Web Application Firewall (WAF)
- [ ] 配置速率限制規則
- [ ] 設置 DDoS 防護
- [ ] 檢查 CORS 設置
- [ ] 驗證環境變量未暴露

### 備份與恢復

- [ ] 記錄當前版本號
- [ ] 創建部署備份
- [ ] 測試回滾流程
- [ ] 文檔化恢復步驟

## 🔄 持續部署

### CI/CD 設置

- [ ] 配置 GitHub Actions 工作流程
- [ ] 設置自動化測試
- [ ] 配置部署觸發條件
- [ ] 設置部署通知

### 版本管理

- [ ] 建立版本標籤策略
- [ ] 設置分支保護規則
- [ ] 配置 PR 審查流程
- [ ] 建立發布日誌

## 📝 文檔更新

### 技術文檔

- [ ] 更新 README.md
- [ ] 記錄 API 變更
- [ ] 更新環境變量說明
- [ ] 記錄已知問題和解決方案

### 團隊溝通

- [ ] 通知團隊部署完成
- [ ] 分享訪問連結
- [ ] 提供測試帳號 (如需要)
- [ ] 安排培訓會議 (如需要)

## ⚠️ 故障排查清單

### 常見問題檢查

- [ ] Workers 日誌是否有錯誤
- [ ] 環境變量是否正確設置
- [ ] 路由規則是否正確配置
- [ ] 資源大小是否超過限制
- [ ] API 端點是否可訪問

### 緊急回滾準備

- [ ] 準備上一個穩定版本
- [ ] 確認回滾命令
- [ ] 準備緊急聯絡人清單
- [ ] 準備狀態頁面更新

---

## 完成確認

- [ ] **所有必要項目已完成**
- [ ] **應用程式在生產環境正常運行**
- [ ] **監控和告警已配置**
- [ ] **文檔已更新**
- [ ] **團隊已通知**

---

_最後更新時間: 2025-08-17_
_負責人: ******\_******_
_審核人: ******\_******_
