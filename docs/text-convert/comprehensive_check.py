#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import re

# æ“´å±•çš„ç°¡é«”å­—åˆ—è¡¨
simplified_patterns = {
    'æ—¶': 'æ™‚',
    'å…³': 'é—œ',
    'äº': 'æ–¼',
    'ä¸“': 'å°ˆ',
    'ä¸š': 'æ¥­',
    'ä»': 'å¾',
    'ä¸ª': 'å€‹',
    'ä¸´': 'è‡¨',
    'ä¸º': 'ç‚º',
    'ä¹‰': 'ç¾©',
    'ä¹ ': 'ç¿’',
    'ä¹¦': 'æ›¸',
    'ä¹°': 'è²·',
    'ä¹±': 'äº‚',
    'äº‰': 'çˆ­',
    'äº': 'æ–¼',
    'äº': 'è™§',
    'äº‘': 'é›²',
    'äº§': 'ç”¢',
    'ä»…': 'åƒ…',
    'ä»': 'å¾',
    'ä¼—': 'çœ¾',
    'ä¼˜': 'å„ª',
    'ä¼š': 'æœƒ',
    'ä¼ ': 'å‚³',
    'ä¼Ÿ': 'å‰',
    'ä¼¤': 'å‚·',
    'ä¼¦': 'å€«',
    'ä¼ª': 'å½',
    'ä¼˜': 'å„ª',
    'ä¼ ': 'å‚³',
    'å€º': 'å‚µ',
    'ä¼¤': 'å‚·',
    'å€¾': 'å‚¾',
    'å…‹': 'å‰‹',
    'å…š': 'é»¨',
    'å…°': 'è˜­',
    'å…³': 'é—œ',
    'å…´': 'èˆˆ',
    'å…½': 'ç¸',
    'å†ˆ': 'å²¡',
    'å†Œ': 'å†Š',
    'å†™': 'å¯«',
    'å†›': 'è»',
    'å†œ': 'è¾²',
    'å†¯': 'é¦®',
    'å†³': 'æ±º',
    'å†µ': 'æ³',
    'å†»': 'å‡',
    'å‡€': 'æ·¨',
    'å‡‰': 'æ¶¼',
    'å‡': 'æ¸›',
    'å‡‘': 'æ¹Š',
    'å‡›': 'å‡œ',
    'å‡ ': 'å¹¾',
    'å‡¤': 'é³³',
    'å‡­': 'æ†‘',
    'å‡¯': 'å‡±',
    'å‡»': 'æ“Š',
    'å‡½': 'å‡½',
    'åˆ†ç¦»': 'åˆ†é›¢',
    'å•': 'å–®',
    'å–': 'è³£',
    'å—': 'å—',
    'åš': 'åš',
    'å«': 'è¡›',
    'å‹': 'å£“',
    'å‚': 'å» ',
    'å…': 'å»³',
    'å†': 'æ­·',
    'å‰': 'å²',
    'å‹': 'å£“',
    'åŒ': 'å­',
    'å•': 'å»',
    'å˜': 'é‡',
    'åš': 'åš',
    'åŸ': 'åŸ',
    'å¢': 'å»‚',
    'å¦': 'å»ˆ',
    'å¨': 'å»š',
    'å©': 'å»„',
    'å®': 'å»',
    'å¿': 'ç¸£',
    'å': 'åƒ',
    'å‚': 'åƒ',
    'åŒ': 'é›™',
    'å‘': 'ç™¼',
    'å˜': 'è®Š',
    'å™': 'æ•˜',
    'å ': 'ç–Š',
    'åª': 'éš»',
    'å°': 'è‡º',
    'å·': 'è™Ÿ',
    'å¹': 'å˜†',
    'å¶': 'è‘‰',
    'å': 'ç±²',
    'å“': 'åš‡',
    'å•': 'å‘‚',
    'å—': 'å—',
    'å‘': 'å¶',
    'å‘•': 'å˜”',
    'å‘›': 'å—†',
    'å‘œ': 'å—š',
    'å‘˜': 'å“¡',
    'å‘¦': 'å–²',
    'å¬': 'è½',
    'å¯': 'å•Ÿ',
    'å‘¼': 'å‘¼',
    'å’': 'è© ',
    'å’™': 'åš¨',
    'å’›': 'åš€',
    'å’¤': 'å’',
    'å’¨': 'è«®',
    'å’¸': 'é¹¹',
    'å“‘': 'å•',
    'å“—': 'å˜©',
    'å“Ÿ': 'å–²',
    'å”¤': 'å–š',
    'å”¯': 'å”¯',
    'å•§': 'å˜–',
    'å•¸': 'å˜¯',
    'å–·': 'å™´',
    'å—¡': 'å—¡',
    'å—£': 'å—£',
    'å˜‰': 'å˜‰',
    'å˜±': 'å›‘',
    'å™œ': 'åš•',
    'åš£': 'å›‚',
    'å›­': 'åœ’',
    'å›´': 'åœ',
    'å›¤': 'å›¤',
    'å›½': 'åœ‹',
    'å›¾': 'åœ–',
    'å›¢': 'åœ˜',
}

def check_file_for_simplified(filename):
    """è©³ç´°æª¢æŸ¥æ–‡ä»¶ä¸­çš„ç°¡é«”å­—"""
    with open(filename, 'r', encoding='utf-8') as f:
        lines = f.readlines()
    
    issues = []
    for line_num, line in enumerate(lines, 1):
        # è·³éç¨‹å¼ç¢¼å€å¡Š
        if line.strip().startswith('```'):
            continue
        
        for simp, trad in simplified_patterns.items():
            if simp in line:
                # ç¢ºèªæ˜¯ä¸­æ–‡ä¸Šä¸‹æ–‡
                if re.search(f'[^a-zA-Z0-9]{simp}[^a-zA-Z0-9]', line):
                    issues.append({
                        'line': line_num,
                        'simp': simp,
                        'trad': trad,
                        'content': line.strip()[:80]
                    })
    
    return issues

def main():
    files = [
        '01-django-basics-for-nodejs-developers.md',
        '02-project-structure-and-planning.md',
        '03-api-implementation-guide.md',
    ]
    
    print("=" * 70)
    print("å®Œæ•´ç°¡é«”å­—æª¢æŸ¥")
    print("=" * 70)
    
    total = 0
    for filename in files:
        print(f"\nğŸ“„ {filename}")
        issues = check_file_for_simplified(filename)
        
        if not issues:
            print("   âœ“ æœªç™¼ç¾ç°¡é«”å­—")
        else:
            print(f"   âš ï¸  ç™¼ç¾ {len(issues)} è™•:")
            for issue in issues[:5]:
                print(f"   ç¬¬ {issue['line']:4d} è¡Œ: '{issue['simp']}' â†’ '{issue['trad']}'")
            if len(issues) > 5:
                print(f"   ... é‚„æœ‰ {len(issues) - 5} è™•")
            total += len(issues)
    
    print("\n" + "=" * 70)
    if total == 0:
        print("âœ… å®Œç¾ï¼æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ç¹é«”ä¸­æ–‡ã€‚")
    else:
        print(f"âš ï¸  å…±ç™¼ç¾ {total} è™•éœ€è¦æª¢æŸ¥")
    print("=" * 70)

if __name__ == '__main__':
    main()
