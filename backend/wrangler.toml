name = "nobodyclimb-api"

main = "src/index.ts"

compatibility_date = "2024-12-01"

compatibility_flags = ["nodejs_compat"]

account_id = "1ff43f0d4c3ad3bd98ce5ab767546a68"

 

# ============================================

# 測試環境 (Preview)

# ============================================

[env.preview]

name = "nobodyclimb-api-preview"

routes = [
  { pattern = "api-preview.nobodyclimb.cc/*", zone_name = "nobodyclimb.cc" }
]

 

[env.preview.vars]

CORS_ORIGIN = "https://nobodyclimb-fe-preview.vincentxuu.workers.dev,http://localhost:3000"

JWT_ISSUER = "nobodyclimb-api"

R2_PUBLIC_URL = "https://storage-preview.nobodyclimb.cc"

# Google OAuth - Set via wrangler secret or environment variable
# GOOGLE_CLIENT_ID = "your-google-client-id.apps.googleusercontent.com"

 

[[env.preview.d1_databases]]

binding = "DB"

database_name = "nobodyclimb-db-preview"

database_id = "7957baa8-d9d1-4e18-aaec-de841b4b846c"

migrations_dir = "migrations"

 

[[env.preview.kv_namespaces]]

binding = "CACHE"

id = "396df52e16864a35a3cb7898fcd686e7"

 

[[env.preview.r2_buckets]]

binding = "STORAGE"

bucket_name = "nobodyclimb-storage-preview"

 

# ============================================

# 正式環境 (Production)

# ============================================

[env.production]

name = "nobodyclimb-api-production"

routes = [

  { pattern = "api.nobodyclimb.cc/*", zone_name = "nobodyclimb.cc" }

]

 

[env.production.vars]

CORS_ORIGIN = "https://nobodyclimb.cc"

JWT_ISSUER = "nobodyclimb-api"

R2_PUBLIC_URL = "https://storage.nobodyclimb.cc"

# Google OAuth - Set via wrangler secret or environment variable
# GOOGLE_CLIENT_ID = "your-google-client-id.apps.googleusercontent.com"

 

[[env.production.d1_databases]]

binding = "DB"

database_name = "nobodyclimb-db"

database_id = "8857a1ac-6e3b-4a2b-8ef4-3e657c0e436d"

migrations_dir = "migrations"

 

[[env.production.kv_namespaces]]

binding = "CACHE"

id = "608d1fb3c4424146abe50ab56e246aca"

 

[[env.production.r2_buckets]]

binding = "STORAGE"

bucket_name = "nobodyclimb-storage"